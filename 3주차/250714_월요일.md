# 2025-07-14 월요일

## 데이터 시각화

### matplotlib

```python
# %matplotlib inline  # 버전이 낮은 노트북에서 그래프가 바로 뜨지 않을 때 사용 % 쉘메소드
import koreanize_matplotlib
import matplotlib as mpl  # 기본 설정 만지는 용도
import matplotlib.pyplot as plt  # 그래프 그리는 용도
import matplotlib.font_manager as fm # 폰트 관련 용도
# 시각화도 결국...
import pandas as pd
import numpy as np
```

```python
plt.plot(x,y,'-.^r') # linestyle, marker, color 순으로 세번째 파라미터에 문자열로 한번에 줄 수 있음
```
```python
import numpy as np

x = np.array(x)
y = np.array(y)

plt.plot(x, y, '-.^b');
plt.plot(x+1, y-2, '--^r');
plt.plot(x-1, y+2, '-->g'); # 여러개의 데이터가 하나의 도화지를 공유
```
```python
plt.xlim(0,5) # x축 limit
plt.ylim(-5,50) # y축 limit
plt.axis('equal') # 정중앙 기준으로 그릴 때
```

```python
plt.plot(np.random.randn(30).cumsum(), '--.b', label='2023년')
plt.plot(np.random.randn(30).cumsum(), '--.g', label='2024년')
plt.plot(np.random.randn(30).cumsum(), '--.r', label='2025년')
plt.axis('equal') # 시각화된 그래프를 정중앙 기준으로 그릴 때
plt.title("3월 매출")
plt.xlabel("시간(단위: 일)")
plt.ylabel("매출(단위: 억원)")
plt.legend(loc='upper right',frameon=False) # 범례
plt.show();
```

```python
# 쓰고 싶은 폰트의 규격이 동일하다면 - dict로 만들어놓고 필요할 때 건네줍니다.
font1 = {'family':'DejaVu Sans','size':25, 'color': 'blue','alpha':0.5}
```

```python
import matplotlib.pyplot as plt

# Look at index 4 and 6, which demonstrate overlapping cases.
x1 = [1, 3, 4, 5, 6, 7, 9]
y1 = [4, 7, 2, 4, 7, 8, 3]

x2 = [2, 4, 6, 8, 10]
y2 = [5, 6, 2, 6, 2]

# Colors: https://matplotlib.org/api/colors_api.html

# 그래프가 여러개의 데이터를 표현할 경우 혹시 누락된 정보가 없는지 확인(덮어씌워짐)
plt.bar(x1, y1, label="Blue Bar", color='b')
plt.bar(x2, y2, label="Green Bar", color='g')
plt.plot()

plt.xlabel("bar number")
plt.ylabel("bar height")
plt.title("Bar Chart Example")
plt.legend()
plt.show() # matplotlib는 input대로 output을 그려줄 뿐
```

```python
import matplotlib.pyplot as plt
import numpy as np

# Use numpy to generate a bunch of random data in a bell curve around 5.
n = 5 + np.random.randn(1000)

m = [m for m in range(len(n))]
plt.bar(m, n)
plt.title("Raw Data")
plt.show()

# 양적변수(연속형 변수)를 특정 구간으로 나눠서 그 범위에 해당하는 데이터의 '빈도'를 막대그래프로 표시
# 양적변수의 경향성(평균 근처에 값이 몰려있는지, 얼마나 몰려있는지 같은 특징을 파악)
plt.hist(n, bins=20) # bins 히스토그램의 구간
plt.title("Histogram")
plt.show()


plt.hist(n, cumulative=True, bins=20) # cumulative - 누적그래프
plt.title("Cumulative Histogram")
plt.show()
```

```python
import matplotlib.pyplot as plt

x1 = [2, 3, 4]
y1 = [5, 5, 5]

x2 = [1, 2, 3, 4, 5]
y2 = [2, 3, 2, 3, 4]
y3 = [6, 8, 7, 8, 7]

# Markers: https://matplotlib.org/api/markers_api.html

# 양적변수와 양적변수 사이의 상관관계를 파악 - 상관관계, 이상치의 분포
plt.scatter(x1, y1)
plt.scatter(x2, y2, marker='v', color='r')
plt.scatter(x2, y3, marker='^', color='m')
plt.title('Scatter Plot Example')
plt.show()
```

```python
import matplotlib.pyplot as plt

idxes = [ 1,  2,  3,  4,  5,  6,  7,  8,  9]
arr1  = [23, 40, 28, 43,  8, 44, 43, 18, 17]
arr2  = [17, 30, 22, 14, 17, 17, 29, 22, 30]
arr3  = [15, 31, 18, 22, 18, 19, 13, 32, 39]

# Adding legend for stack plots is tricky.
plt.plot([], [], color='r', label = 'D 1')
plt.plot([], [], color='g', label = 'D 2')
plt.plot([], [], color='b', label = 'D 3')

plt.stackplot(idxes, arr1, arr2, arr3, colors= ['r', 'g', 'b'])
plt.title('Stack Plot Example')
plt.legend()
plt.show()
```

```python
import matplotlib.pyplot as plt

labels = 'S1', 'S2', 'S3'
sections = [56, 66, 24]
colors = ['c', 'g', 'y']

plt.pie(sections, labels=labels, colors=colors,
        startangle=120,
        explode = (0, 0.1, 0), # 틈새
        autopct = '%1.2f%%' # autopercent - 소수점 둘째짜리까지 비율을 계산해 출력해다오
        )

plt.axis('equal') # Try commenting this out.
plt.title('Pie Chart Example')
plt.show()
```

```python
import matplotlib.pyplot as plt
import numpy as np

ys = 200 + np.random.randn(100)
x = [x for x in range(len(ys))]

plt.plot(x, ys, '-')
plt.fill_between(x, ys, 195, where=(ys > 195),facecolor='g', alpha=0.6) # 195, where=(ys > 195) : xlim(195, ~ )와 같은 명령어

plt.title("Fills and Alpha Example")
plt.show()
```

```python
import matplotlib.pyplot as plt
import numpy as np

def random_plots():
  xs = []
  ys = []

  for i in range(20):
    x = i
    y = np.random.randint(10)

    xs.append(x)
    ys.append(y)

  return xs, ys

fig = plt.figure()
ax1 = plt.subplot2grid((5, 2), (0, 0), rowspan=1, colspan=2)
ax2 = plt.subplot2grid((5, 2), (1, 0), rowspan=3, colspan=2)
ax3 = plt.subplot2grid((5, 2), (4, 0), rowspan=1, colspan=1)
ax4 = plt.subplot2grid((5, 2), (4, 1), rowspan=1, colspan=1)

x, y = random_plots()
ax1.plot(x, y)

x, y = random_plots()
ax2.plot(x, y)

x, y = random_plots()
ax3.plot(x, y)

x, y = random_plots()
ax4.plot(x, y)

plt.tight_layout()
plt.show()
```

```python
import matplotlib.pyplot as plt
import numpy as np
from mpl_toolkits.mplot3d import axes3d

fig = plt.figure()
ax = fig.add_subplot(111, projection = '3d')

x1 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
y1 = np.random.randint(10, size=10)
z1 = np.random.randint(10, size=10)

x2 = [-1, -2, -3, -4, -5, -6, -7, -8, -9, -10]
y2 = np.random.randint(-10, 0, size=10)
z2 = np.random.randint(10, size=10)

ax.scatter(x1, y1, z1, c='b', marker='o', label='blue')
ax.scatter(x2, y2, z2, c='g', marker='D', label='green')

ax.set_xlabel('x axis')
ax.set_ylabel('y axis')
ax.set_zlabel('z axis')
plt.title("3D Scatter Plot Example")
plt.legend()
plt.tight_layout()
plt.show()
```

```python
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.add_subplot(111, projection = '3d')

x = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
y = np.random.randint(10, size=10)
z = np.zeros(10)

dx = np.ones(10)
dy = np.ones(10)
dz = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

ax.bar3d(x, y, z, dx, dy, dz, color='g')

ax.set_xlabel('x axis')
ax.set_ylabel('y axis')
ax.set_zlabel('z axis')
plt.title("3D Bar Chart Example")
plt.tight_layout()
plt.show()
```

```python
import matplotlib.pyplot as plt

fig = plt.figure()
ax = fig.add_subplot(111, projection = '3d')

x, y, z = axes3d.get_test_data()

ax.plot_wireframe(x, y, z, rstride = 2, cstride = 2)

plt.title("Wireframe Plot Example")
plt.tight_layout()
plt.show()
```

### Seaborn
```python
import seaborn as sns

sns.set_theme(style="ticks")

# Load the example dataset for Anscombe's quartet
df = sns.load_dataset("anscombe")

# Show the results of a linear regression within each dataset
sns.lmplot(
    data=df, x="x", y="y", col="dataset", hue="dataset",
    col_wrap=2, palette="muted", ci=None,
    height=4, scatter_kws={"s": 50, "alpha": 1},markers='^'
)

plt.savefig('lm.png') # 파일 저장 - matplotlib와 혼용 가능
```

```python
sns.barplot(x=x, y=y1, hue = x, legend=False, palette="rocket")
```

```python
rs = np.random.RandomState(8)
# Set up the matplotlib figure
f, ([ax1, ax2], [ax3, ax4]) = plt.subplots(2, 2, figsize=(7, 5), sharex=True) # 2x2개의 서브플롯으로 된 도화지를 그리겠다 /한 row마다 리스트로 묶여야함

sns.barplot(x=x, y=y1, palette="rocket", ax=ax1) # ax=ax1 : 첫번째 그래프 의미
ax1.axhline(0, color="k", clip_on=False) # 수평선 그린다
ax1.set_ylabel("Sequential") # 서브플롯일 때 ylabel 지정해주는 옵션
# Center the data to make it diverging
y2 = y1 - 5.5
sns.barplot(x=x, y=y2, palette="vlag", ax=ax2)
ax2.axhline(0, color="k", clip_on=False)
ax2.set_ylabel("Diverging")

# Randomly reorder the data to make it qualitative
y3 = rs.choice(y1, len(y1), replace=False)
sns.barplot(x=x, y=y3, palette="deep", ax=ax3)
ax3.axhline(0, color="k", clip_on=False)
ax3.set_ylabel("Qualitative")

# Randomly reorder the data to make it qualitative
y4 = rs.choice(y1, len(y1), replace=False)
sns.barplot(x=x, y=y4, palette="deep", ax=ax4)
ax3.axhline(0, color="k", clip_on=False)
ax3.set_ylabel("Qualitative2")

# Finalize the plot
sns.despine(bottom=True) # 축/테두리 제거
plt.setp(f.axes, yticks=[])
plt.tight_layout(h_pad=2)
```

```python
sns.lineplot(data=tips, x='day',y='total_bill', ci=None, estimator='count') # 타겟 컬럼 평균으로 리턴
```

```python
sns.scatterplot(tips,x='total_bill',y='tip')
```

```python
sns.countplot(tips, x = 'sex',hue='sex')
```

```python
# 양적변수 - 일변량 - n개의구간으로 나누어서 그 구간에 해당하는 값의 '개수'를 셉니다
sns.displot(tips, x='total_bill', bins=10, kde=True)
```

```python
sns.kdeplot(tips, x='total_bill')
# 특정 구간에 어느 정도 분포가 있을지를 통계적으로 계산해서 출력하면서
# 전체 데이터의 총합이 1이 되도록 y축의 값이 바뀝니다.
```

```python
sns.boxplot(tips,x='sex',y='tip',hue = 'sex')
```

```python
sns.violinplot(tips,x='time',y='tip',hue='smoker')
```

```python
import matplotlib.pyplot as plt
import seaborn as sns
sns.set_theme()

# Load the example flights dataset and convert to long-form
flights_long = sns.load_dataset("flights")
flights = (
    flights_long
    .pivot(index="month", columns="year", values="passengers")
)

# Draw a heatmap with the numeric values in each cell
f, ax = plt.subplots(figsize=(9, 6))
sns.heatmap(flights, annot=True, fmt="d", linewidths=.5, ax=ax)
```

```python
sns.pairplot(tips, hue='day') # 각 데이터 열의 조합으로plot
```

## 오늘의 포인트
- subplot과 title, label, axis, marker,color 등 키워드 기억만 해두기
- 필요할때는 공식문서나 GPT 참고
